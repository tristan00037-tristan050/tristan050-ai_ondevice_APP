# Headers Policy (Policy-as-Code v1)
# Fail-Closed: 필수 헤더 누락 시 요청 차단
# SSOT v3.4 alignment: required headers are X-Tenant, X-User-Id, X-User-Role (+ Idempotency-Key for export)

version: "1.0"
rules:
  - id: "header_live_required_v3_4"
    name: "Live 요청 필수 헤더(SSOT v3.4)"
    description: "Live 요청은 X-Tenant/X-User-Id/X-User-Role 헤더가 반드시 필요합니다."
    required_headers:
      - "X-Tenant"
      - "X-User-Id"
      - "X-User-Role"
    action: "block"

  - id: "header_export_required_v3_4"
    name: "Export 요청 필수 헤더(SSOT v3.4)"
    description: "Export 요청은 Idempotency-Key 및 X-Tenant/X-User-Id/X-User-Role 헤더가 반드시 필요합니다."
    required_headers:
      - "Idempotency-Key"
      - "X-Tenant"
      - "X-User-Id"
      - "X-User-Role"
    action: "block"
