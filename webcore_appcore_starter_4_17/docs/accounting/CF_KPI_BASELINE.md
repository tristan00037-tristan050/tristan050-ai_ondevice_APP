# 회계 KPI 정의 및 측정법

R6 회계 확장 - KPI 정의 및 측정 기준

## KPI 정의

### 1. 분개 추천 정확도

**정의**: 추천된 분개가 실제 정답(골든셋)과 일치하는 비율

**측정 방법**:
- TOP-1 정확도: 첫 번째 추천이 정답과 일치하는 비율
- TOP-N 정확도: 상위 N개 추천 중 정답이 포함된 비율 (N=3, 5)

**계산식**:
```
TOP-1 정확도 = (정확히 일치한 분개 수 / 전체 테스트 케이스) * 100
TOP-N 정확도 = (상위 N개에 정답 포함된 분개 수 / 전체 테스트 케이스) * 100
```

**목표값**:
- TOP-1: ≥ 70%
- TOP-3: ≥ 85%
- TOP-5: ≥ 90%

---

### 2. 분개 추천 신뢰도

**정의**: 추천 시스템이 제공하는 신뢰도 점수의 평균

**측정 방법**:
- 각 추천에 대한 `confidence` 값 (0.0 ~ 1.0)
- 전체 추천의 평균 신뢰도

**계산식**:
```
평균 신뢰도 = Σ(confidence_i) / N
```

**목표값**:
- 평균 신뢰도: ≥ 0.75

---

### 3. 처리 시간 (Latency)

**정의**: 분개 추천 API 응답 시간

**측정 방법**:
- `POST /v1/accounting/postings/suggest` 응답 시간
- P95, P99 백분위수 측정

**목표값**:
- P95: ≤ 500ms
- P99: ≤ 1000ms

---

### 4. 승인 처리 시간

**정의**: 승인 요청부터 승인 완료까지의 시간

**측정 방법**:
- 승인 요청 시각 ~ 승인 완료 시각
- 평균, P95, P99 측정

**목표값**:
- 평균: ≤ 1시간
- P95: ≤ 4시간

---

### 5. Export 처리 시간

**정의**: Export 요청부터 완료까지의 시간

**측정 방법**:
- Export 요청 시각 ~ Export 완료 시각
- Job 상태 추적

**목표값**:
- 평균: ≤ 5분 (1000건 기준)
- 최대: ≤ 30분 (10000건 기준)

---

### 6. 정책 위반률

**정의**: 정책 검증 실패 비율

**측정 방법**:
- 정책 검증 실패 수 / 전체 분개 시도 수

**목표값**:
- 정책 위반률: ≤ 5%

---

## 측정 스크립트

### 정확도 측정

```bash
# 골든셋을 사용한 정확도 측정
node scripts/measure_accuracy.js \
  --gold datasets/gold/ledgers.json \
  --output reports/accuracy_report.json
```

### 성능 측정

```bash
# API 응답 시간 측정
npm run benchmark:accounting
```

---

## 벤치마크 기준

### 캠프파이어 대비

| KPI | 캠프파이어 | 목표 | 현재 |
|-----|-----------|------|------|
| TOP-1 정확도 | 75% | ≥ 70% | 측정 중 |
| 평균 신뢰도 | 0.80 | ≥ 0.75 | 측정 중 |
| 추천 응답 시간 | 300ms | ≤ 500ms | 측정 중 |

---

## 참고

- 골든셋: `datasets/gold/ledgers.json`
- 정확도 리포트: `reports/accuracy_report.json`
- 성능 리포트: `reports/performance_report.json`


