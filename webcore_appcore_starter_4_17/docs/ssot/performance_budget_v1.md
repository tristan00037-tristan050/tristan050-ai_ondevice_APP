# 성능 예산 v1 (SSOT)

**버전**: v1.0  
**생성일**: 2026-01-09  
**목적**: 성능 예산 SSOT 정의 및 다운시프트 임계치

## 성능 예산 정의

### Latency 임계치

| 레벨 | P95 Latency 임계치 | 설명 |
|------|-------------------|------|
| L0 (최고 성능) | < 200ms | 최적 성능 상태 |
| L1 (정상) | 200ms ~ 400ms | 정상 범위 |
| L2 (경고) | 400ms ~ 600ms | 성능 저하 시작 |
| L3 (위험) | 600ms ~ 800ms | 심각한 성능 저하 |
| L4 (최대) | ≥ 800ms | 최대 다운시프트 |

### 다운시프트 레벨 (downshift_level)

- **0**: 최고 성능 모드 (L0)
- **1**: 정상 모드 (L1)
- **2**: 경고 모드 (L2)
- **3**: 위험 모드 (L3)
- **4**: 최대 다운시프트 모드 (L4)

### 히스테리시스 임계치 (채터링 방지)

**상향 임계치 (downshift 증가)**: latency가 이 값을 넘으면 downshift_level 증가
- L0 → L1: 400ms
- L1 → L2: 600ms
- L2 → L3: 800ms
- L3 → L4: 1000ms

**하향 임계치 (downshift 감소)**: latency가 이 값 이하로 떨어져야 downshift_level 감소
- L4 → L3: 700ms
- L3 → L2: 500ms
- L2 → L1: 300ms
- L1 → L0: 150ms

**히스테리시스 간격**: 상향 임계치와 하향 임계치 사이의 간격으로 채터링 방지
- L0↔L1: 150ms ~ 400ms (250ms 간격)
- L1↔L2: 300ms ~ 600ms (300ms 간격)
- L2↔L3: 500ms ~ 800ms (300ms 간격)
- L3↔L4: 700ms ~ 1000ms (300ms 간격)

## 예산 상한 (불변)

- **P95 Latency 상한**: 1000ms (절대 초과 불가)
- **게이트 의미**: 예산 상한 초과 시 Fail-Closed (시스템 차단 또는 최대 다운시프트)

## Latency Bucket 정의

| Bucket | 범위 | 설명 |
|--------|------|------|
| EXCELLENT | < 200ms | 최고 성능 |
| GOOD | 200ms ~ 400ms | 정상 성능 |
| FAIR | 400ms ~ 600ms | 경고 수준 |
| POOR | 600ms ~ 800ms | 위험 수준 |
| VERY_POOR | ≥ 800ms | 최대 다운시프트 |

## 히스테리시스 상태 (hysteresis_state)

- **STABLE**: 현재 레벨 유지 (히스테리시스 범위 내)
- **UPWARD**: 상향 임계치 초과 (downshift_level 증가)
- **DOWNWARD**: 하향 임계치 미만 (downshift_level 감소)

